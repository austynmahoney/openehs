<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
                   assembly="OpenEhs.Domain"
                   namespace="OpenEhs.Domain">
  <class name="PatientCheckIn" table="PatientCheckIn" >
    <id name="Id" column="PatientCheckInID">
      <generator class="native" />
    </id>
    <property name="CheckInTime" not-null="true" />
    <property name="PatientType" not-null="true" />
    <property name="CheckOutTime" not-null="false" />
    <property name="Diagnosis" not-null="false" />
    <property name="TimeOfDeath" not-null="false" />

    <one-to-one name="AttendingStaff" 
                cascade="save-update"
                constrained="true"
                foreign-key="none"
                class="Staff" />
    
    <many-to-one name="Patient" column="PatientID" unique="true" cascade="all" />

    <one-to-one name="Invoice"
                cascade="all"
                constrained="true"
                foreign-key="none"
                class="Invoice" />
    
    <property name="IsActive" not-null="true" />

    <bag name="Surgeries" table="Surgery" cascade="all">
      <key column="PatientCheckInID" />
      <one-to-many class="Surgery" />
    </bag>

    <bag name="Vitals" table="Vitals" cascade="all">
      <key column="PatientCheckInId" />
      <one-to-many class="Vitals" />
    </bag>

    <many-to-one name="Location" column="LocationID" unique="true" cascade="all" />

    <bag name="FeedChart" table="FeedChart" cascade="all">
      <key column="PatientCheckInId" />
      <one-to-many class="FeedChart" />
    </bag>

    <bag name="IntakeChart" table="IntakeChart" cascade="all">
      <key column="PatientCheckInId" />
      <one-to-many class="IntakeChart" />
    </bag>

    <bag name="OutputChart" table="OutputChart" cascade="all">
      <key column="PatientCheckInId" />
      <one-to-many class="OutputChart" />
    </bag>
  </class>
</hibernate-mapping>